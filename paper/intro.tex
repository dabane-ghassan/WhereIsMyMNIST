\section{Introduction}

\subsection{Issue}

\subsection{State of the art}

\subsection{Outline}

\subsubsection{Notations}
\begin{itemize}
	\item $\boldsymbol{x}$ : visual field (signal)
	\item $\boldsymbol{y}$ : target category 
	\item $\boldsymbol{z}$ : target position (head-centered referential)
	\item $\boldsymbol{e}$ : eyes orientation (head-centered referential)
	\item $\boldsymbol{u} = \boldsymbol{z} - \boldsymbol{e}$ : target position (retinocentric referential)

\end{itemize}

Generative model :
$$ \boldsymbol{x} \sim P(X|\boldsymbol{y}, \boldsymbol{u}) $$

Full inference (posterior):
$$ P(Y, U|\boldsymbol{x}) \propto  P(\boldsymbol{x}|Y, U) $$

%Independence assumption :
%$$ P(Y, U|\boldsymbol{x}) = P(Y|\boldsymbol{x})  P(U|\boldsymbol{x}) $$

Partial inference on object category:
$$ P(Y|\boldsymbol{x}, \boldsymbol{u}) \propto  P(\boldsymbol{x}|Y, \boldsymbol{u}) $$

Partial inference on object position:
$$ P(U|\boldsymbol{x}, \boldsymbol{y}) \propto  P(\boldsymbol{x}|U, \boldsymbol{y}) $$

Marginals:
\begin{itemize}
\item $ P(Y|\boldsymbol{x}) = \int P(Y|\boldsymbol{x}, \boldsymbol{u}) d\boldsymbol{u}$
\item $ P(U|\boldsymbol{x}) = \int P(U|\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{y}$
\end{itemize}


\subsubsection{Case 1: Visual information gain maximization}\label{sec:case1}

Consider a view $\boldsymbol{x}$ generated from a target $\boldsymbol{y}$ viewed at retinocentric position $\boldsymbol{u}$. 

Consider first that :
\begin{itemize}
	\item The generative model  $p(X|\boldsymbol{y}, \boldsymbol{u})$ is known
	\item The retinocentric position  $\boldsymbol{u}$ is known.
	\item The view $\boldsymbol{x}$ is known.
	\item The target category  $\boldsymbol{y}$ is unknown.
\end{itemize} 



The question comes how to choose the new retinocentric position $\boldsymbol{u}'$ in order to maximize the \emph{mutual information} between $\boldsymbol{x}|\boldsymbol{u}$ (current view) and $\boldsymbol{x}'|\boldsymbol{u}'$ (future view).

In general, the visual Information Gain between two visual fields $\boldsymbol{x}|\boldsymbol{u}$  and $\boldsymbol{x}'|\boldsymbol{u}'$ is:

\begin{align*}
\text{IG}(\boldsymbol{x}|\boldsymbol{u}; \boldsymbol{x}'| \boldsymbol{u}') 
&= -\log p(\boldsymbol{x}|\boldsymbol{u}) 
+ \log p(\boldsymbol{x}|\boldsymbol{u}, \boldsymbol{x}', \boldsymbol{u}')
\end{align*}

Consider now that given  $\boldsymbol{x}$ and $\boldsymbol{u}$, the target category  $\boldsymbol{y}$ can be \emph{inferred} using Bayes rule, i.e.:
$$ P(Y|\boldsymbol{x}, \boldsymbol{u}) \propto  P(\boldsymbol{x}|Y, \boldsymbol{u}) $$. 
Then, it can be shown (see \cite{dauce2018}) that :
$$\text{IG}(\boldsymbol{x}|\boldsymbol{u}; \boldsymbol{x}'| \boldsymbol{u}') \geq \mathbb{E}_{\boldsymbol{y}\sim p(Y|\boldsymbol{x}, \boldsymbol{u})} \left[\log p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}') - \log(\pi(\boldsymbol{y})) \right]$$
with  $\pi(\boldsymbol{y})$ the prior over the $\boldsymbol{y}$'s .

When the prior is uniform\footnote{The information gain lower bound (IGLB) simplifies to $\mathbb{E}_{\boldsymbol{y}\sim p(Y|\boldsymbol{x}, \boldsymbol{u})} \left[\log p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}')\right] + c$, with $c$ a constant, when the prior on $Y$ is uniform.}, one can adopt a \emph{predictive} approach to choose the new eye orientation $\boldsymbol{e}'$:
\begin{itemize}
	\item First choose a new retinocentric position $\boldsymbol{u}'$ that will maximize the  information gain.
	\item Then choose $\boldsymbol{e}'$ such that $$\boldsymbol{z} - \boldsymbol{e}' = \boldsymbol{u}'$$ i.e. $$\boldsymbol{e}' = \boldsymbol{e} + \boldsymbol{u} - \boldsymbol{u}'$$
\end{itemize}

The predictive approach needs three predictive steps:
\begin{itemize}
	\item $p(Y|\boldsymbol{x}, \boldsymbol{u})$ is the current posterior over the target category inferred from the current observation,
	\item $\boldsymbol{x}'\sim p(X|\boldsymbol{y},\boldsymbol{u}')$ is the predicted view generated by the model assuming that the target $\boldsymbol{y}$ is seen from from $\boldsymbol{u}'$,
	\item and $p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}')$ the predicted posterior from   assumption $\boldsymbol{y}$, given $\boldsymbol{x}'$ and $\boldsymbol{u}'$.
\end{itemize}

The optimal new retinocentric position is then:
\begin{align*}
\hat{\boldsymbol{u}}' &= \underset{\boldsymbol{u}' }{\text{ argmax }} 
 \mathbb{E}_{\boldsymbol{y}\sim p(Y|\boldsymbol{x}, \boldsymbol{u})}  
 \left[\mathbb{E}_{ \boldsymbol{x}' \sim p(X|\boldsymbol{y}, \boldsymbol{u}')}
 \left[\log p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}')\right]\right]\\
  %&= \underset{\boldsymbol{u}' \in \mathcal{U}}{\text{ argmax }} A(\boldsymbol{u}'|\boldsymbol{x}, \boldsymbol{u})
\end{align*}
Taking $\delta \boldsymbol{e} = \boldsymbol{u} - \boldsymbol{u}'$ the eye displacement, 
\begin{align*}
\widehat{\delta\boldsymbol{e}} &= \underset{\delta\boldsymbol{e} }{\text{ argmax }} 
\mathbb{E}_{\boldsymbol{y}\sim p(Y|\boldsymbol{x}, \boldsymbol{u})}  
\left[\mathbb{E}_{ \boldsymbol{x}' \sim p(X|\boldsymbol{y}, \boldsymbol{u}- \delta \boldsymbol{e})}
\left[\log p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}-\delta\boldsymbol{e})\right]\right]\\
%&= \underset{\delta\boldsymbol{e}}{\text{ argmax }} A(\delta\boldsymbol{e}|\boldsymbol{x}, \boldsymbol{u})
\end{align*}
%with $A(\delta\boldsymbol{e}|\boldsymbol{x}, \boldsymbol{u})$ the IGLB\footnote{Information Gain Lower Bound} map.



 
\subsubsection{Case 2: }
Consider now that :
\begin{itemize}
	\item The generative model  $p(X|\boldsymbol{y}, \boldsymbol{u})$ is known
	\item The retinocentric position  $\boldsymbol{u}$ is unknown.
	\item The view $\boldsymbol{x}$ is known.
	\item The target category  $\boldsymbol{y}$ is unknown.
\end{itemize} 

Given $\boldsymbol{x}$ only, both the retinocentric position $\boldsymbol{u}$ and the category $\boldsymbol{y}$ can be inferred by inference:
$$\boldsymbol{u}, \boldsymbol{y}\sim P(U,Y|\boldsymbol{x})$$
Then:
\begin{align*}
\hat{\boldsymbol{u}}' &= \underset{\boldsymbol{u}' \in \mathcal{U}}{\text{ argmax }} 
\mathbb{E}_{\boldsymbol{u},\boldsymbol{y}\sim p(U,Y|\boldsymbol{x})} 
\left[\mathbb{E}_{ \boldsymbol{x}' \sim p(X|\boldsymbol{y}, \boldsymbol{u}')}
\left[\log p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}')\right]\right]
\end{align*}

Knowing that:
\begin{align*}
p(U,Y|\boldsymbol{x}) 
&= p(Y|\boldsymbol{x})p(U|\boldsymbol{x},Y)
\end{align*}
and considering
$\delta \boldsymbol{e} = \boldsymbol{u} - \boldsymbol{u}'$ the eye displacement, the optimal eye displacement writes:
\begin{align*}
\widehat{\delta\boldsymbol{e}} &= \underset{\delta\boldsymbol{e}}{\text{ argmax }} 
\mathbb{E}_{\boldsymbol{y}\sim p(Y|\boldsymbol{x})}\left[
\mathbb{E}_{\boldsymbol{u}\sim p(U|\boldsymbol{x}, \boldsymbol{y})}  
\left[\mathbb{E}_{ \boldsymbol{x}' \sim p(X|\boldsymbol{y}, \boldsymbol{u} - \delta\boldsymbol{e})}
\left[\log p(\boldsymbol{y}|\boldsymbol{x}', \boldsymbol{u}- \delta\boldsymbol{e})\right]\right]\right]\\
&= \underset{\delta\boldsymbol{e}}{\text{ argmax }} Q(\delta\boldsymbol{e}|\boldsymbol{x})
\end{align*}
with $Q(\delta\boldsymbol{e}|\boldsymbol{x})$ the IGLB\footnote{Information Gain Lower Bound} map.

\subsubsection{Algorithms}

It is not possible in practice to provide an exhaustive prediction. A sampling approach is generally used instead to approximate the future posteriors.

\paragraph{General case}
Taking greedy samples, it simplifies to :
\begin{enumerate}
	\item Identify the target :
$\tilde{\boldsymbol{y}} \sim  p(\boldsymbol{y}|\boldsymbol{x})$
\item Estimate its retinocentric position : 
$\hat{\boldsymbol{u}} = \underset{\boldsymbol{u}}{\text{ argmax }} p(\boldsymbol{u}|\boldsymbol{x}, \tilde{\boldsymbol{y}})$
\item For each $\delta\boldsymbol{e}$, 
\begin{itemize}
	\item estimate
	$\hat{\boldsymbol{x}}'_{\delta\boldsymbol{e}} = \underset{\boldsymbol{x}'}{\text{ argmax }} p(\boldsymbol{x}'|\tilde{\boldsymbol{y}}, \hat{\boldsymbol{u}}-\delta\boldsymbol{e})$
\end{itemize}
\item
Choose $\widehat{\delta\boldsymbol{e}} = \underset{\delta\boldsymbol{e}}{\text{ argmax }} \log p(\tilde{\boldsymbol{y}}|\hat{\boldsymbol{x}}'_{\delta\boldsymbol{e}}, \hat{\boldsymbol{u}} - \delta\boldsymbol{e})$
\end{enumerate}

\paragraph{Our case}
When the target is not identified first (our case):
\begin{enumerate}
	\item Estimate the target retinocentric position using the marginal posterior: 
	$$\hat{\boldsymbol{u}} = \underset{\boldsymbol{u}}{\text{ argmax }} p(\boldsymbol{u}|\boldsymbol{x})$$
	\item Optimize $\delta\boldsymbol{e}$ according to paragr. \ref{sec:case1} : 
	$$\widehat{\delta\boldsymbol{e}} = \underset{\delta\boldsymbol{e}}{\text{ argmax }} 
	\mathbb{E}_{\boldsymbol{y}\sim p(Y|\boldsymbol{x}, \hat{\boldsymbol{u}})}  
	\left[\mathbb{E}_{ \boldsymbol{x}' \sim p(X|\boldsymbol{y}, \hat{\boldsymbol{u}} - \delta\boldsymbol{e})}
	\left[\log p(\boldsymbol{y}|\boldsymbol{x}', \hat{\boldsymbol{u}}- \delta\boldsymbol{e})\right]\right]$$
\end{enumerate}

TODO :
\begin{itemize}
	\item Link with accuracy map $$A_{\boldsymbol{u}} = P(Y = \hat{\boldsymbol{y}}|\boldsymbol{x}, \boldsymbol{u})
	\text{,  knowing  : }
	\boldsymbol{x} \sim P(X|\hat{\boldsymbol{y}}, \boldsymbol{u})??? $$
	$$A_{\boldsymbol{u}} = P(Y = \hat{\boldsymbol{y}}|\boldsymbol{x})
	\text{,  knowing  : }
	\boldsymbol{x} \sim P(X|\hat{\boldsymbol{y}}, \boldsymbol{u}) ???$$
	\item Ergodic assumption
	\item Link with (Entropy/Free Energy minimization) :
	\begin{itemize}
		\item unsupervised case
		\item intrinsic motivation
	\end{itemize}
\end{itemize}

Accuracy map : 


Action selection ($\boldsymbol{u}$ is unknown):
\begin{itemize}
	\item 
	
	\begin{enumerate}
		\item Read $\boldsymbol{x}$
		\item Estimate $\tilde{\boldsymbol{u}} \sim P(U|\boldsymbol{x})$ (Colliculus)
		\item Choose action $\mathcal{T}_{\boldsymbol{\Delta u}}$ such that :
		$$\boldsymbol{u} \leftarrow \boldsymbol{u} + \underset{\Delta\boldsymbol{u}} {\text{ argmax }}
		A_{\tilde{\boldsymbol{u}} + \Delta\boldsymbol{u}}$$
		\item Read $\boldsymbol{x}'$ (Transformed input)
		\item Classify $\tilde{\boldsymbol{y}} \sim P(Y|\boldsymbol{x}')$
		\item Compare with true label $\hat{\boldsymbol{y}}$
	\end{enumerate}
\end{itemize}

